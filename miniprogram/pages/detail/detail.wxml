<view class="container" wx:if="{{record}}">
  <!-- åŠ¨æ€èƒŒæ™¯ -->
  <view class="dynamic-bg">
    <view class="bg-gradient"></view>
    <view class="decorations">
      <view class="blob blob-1"></view>
      <view class="blob blob-2"></view>
      <view class="blob blob-3"></view>
    </view>
  </view>

  <!-- å›¾ç‰‡å¡ç‰‡å †å  -->
  <view 
    class="card-container"
    bindtouchstart="onTouchStart"
    bindtouchmove="onTouchMove"
    bindtouchend="onTouchEnd"
  >
    <view 
      wx:for="{{record.imageUrl}}" 
      wx:key="index"
      class="card-item {{currentImageIndex === index ? 'active' : ''}}"
      style="transform: translateX({{currentImageIndex === index ? translateX : (currentImageIndex > index ? 120 : -120)}}px) scale({{currentImageIndex === index ? (1 - Math.abs(translateX) / 1000) : 0.9}});"
    >
      <view class="card-image-wrapper">
        <image 
          class="card-image" 
          src="{{item}}" 
          mode="aspectFill"
        ></image>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨ä¿¡æ¯æ  -->
  <view class="bottom-bar">
    <view class="bottom-content">
      <view class="meal-info">
        <view class="meal-tag" style="background: linear-gradient(135deg, {{mealTypeInfo.color}} 0%, {{mealTypeInfo.color}}CC 100%);">
          <text class="meal-emoji">{{mealTypeInfo.emoji}}</text>
          <text class="meal-label">{{mealTypeInfo.label}}</text>
        </view>
      </view>
      <view class="page-indicator">
        <text>{{currentImageIndex + 1}} / {{record.imageUrl.length}}</text>
      </view>
      <view class="menu-btn" bindtap="onMoreTap">
        <text class="menu-icon">â€¢â€¢â€¢</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œèœå• -->
  <view class="action-sheet-mask {{showActionSheet ? 'show' : ''}}" bindtap="onCloseActionSheet"></view>
  <view class="action-sheet {{showActionSheet ? 'show' : ''}}">
    <view class="sheet-item" bindtap="onSavePoster" wx:if="{{isOwner}}">
      <text class="sheet-icon">ğŸ–¼ï¸</text>
      <text class="sheet-text">ä¿å­˜æµ·æŠ¥</text>
    </view>
    <view class="sheet-item" bindtap="onDeleteTap" wx:if="{{isOwner}}">
      <text class="sheet-icon" style="color: #FF6B6B;">ğŸ—‘ï¸</text>
      <text class="sheet-text" style="color: #FF6B6B;">åˆ é™¤è®°å½•</text>
    </view>
    <view class="sheet-cancel" bindtap="onCloseActionSheet">å–æ¶ˆ</view>
  </view>

  <!-- æµ·æŠ¥ç”»å¸ƒ -->
  <view class="poster-canvas-container">
    <canvas type="2d" id="posterCanvas" style="width: 320px; height: 480px;"></canvas>
  </view>
</view>
