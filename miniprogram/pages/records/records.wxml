<view class="container">
  <!-- È°µÈù¢Â§¥ÈÉ® -->
  <view class="page-header">
    <view class="header-content">
      <text class="page-title">ÊàëÁöÑËÆ∞ÂΩï</text>
      <text class="record-count" wx:if="{{records.length > 0}}">{{records.length}} Êù°</text>
    </view>
    <view class="menu-btn" bindtap="onMenuTap">
      <view class="menu-dots">
        <view></view><view></view><view></view>
      </view>
    </view>
  </view>

  <!-- Á≠õÈÄâÁä∂ÊÄÅÊ†è -->
  <view class="filter-bar" wx:if="{{isFilterActive}}">
    <view class="filter-content">
      <text class="filter-text">{{filterText}}</text>
    </view>
    <view class="reset-btn" bindtap="onResetFilter">
      <text>ÈáçÁΩÆ</text>
    </view>
  </view>

  <!-- Êó∂ÂÖâËΩ¥ÂàóË°® -->
  <scroll-view 
    class="timeline" 
    scroll-y 
    enhanced 
    show-scrollbar="{{false}}"
    bindscroll="onScroll"
  >
    <view class="timeline-list" wx:if="{{groupKeys.length > 0}}">
      <view 
        wx:for="{{groupKeys}}" 
        wx:key="index" 
        wx:for-index="groupIndex"
        class="timeline-group"
      >
        <!-- ÂàÜÁªÑÊó•Êúü -->
        <view class="timeline-date">
          <view class="date-line"></view>
          <text class="date-text">{{item}}</text>
        </view>
        
        <!-- Êó∂Èó¥Á∫ø -->
        <view class="timeline-items">
          <view 
            wx:for="{{groupedRecords[item]}}"
            wx:for-item="record"
            wx:key="id"
            wx:for-index="itemIndex"
            class="timeline-item {{currentItemId === record.id ? 'active' : ''}}"
            data-id="{{record.id}}"
            bindtap="onRecordTap"
            style="animation-delay: {{(groupIndex * 3 + itemIndex) * 0.05}}s"
          >
            <!-- Êó∂Èó¥Á∫øÂ∑¶‰æß -->
            <view class="timeline-left">
              <view class="time-dot">
                <view class="dot-inner"></view>
              </view>
              <view class="time-line"></view>
            </view>
            
            <!-- Âç°Áâá -->
            <view class="timeline-card">
              <view class="card-image-wrapper">
                <image 
                  class="card-image" 
                  src="{{record.imageUrl[0]}}" 
                  mode="aspectFill"
                  lazy-load
                ></image>
                <view class="image-count-badge" wx:if="{{record.imageUrl.length > 1}}">
                  <text>{{record.imageUrl.length}}</text>
                </view>
                <view class="meal-tag" style="background: linear-gradient(135deg, {{record.mealInfo.color}} 0%, {{record.mealInfo.color}}CC 100%);">
                  <text class="meal-emoji">{{record.mealInfo.emoji}}</text>
                </view>
              </view>
              <view class="card-info">
                <text class="card-title">{{record.title}}</text>
                <text class="card-time">{{record.mealInfo.label}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- Á©∫Áä∂ÊÄÅ -->
    <view class="empty-state" wx:else>
      <view class="empty-emoji">üçΩÔ∏è</view>
      <text class="empty-text">ËøòÊ≤°ÊúâËÆ∞ÂΩïÂì¶</text>
      <text class="empty-hint">ËÆ∞ÂΩï‰Ω†ÁöÑÁ¨¨‰∏ÄÈ°øÈ•≠Âêß</text>
    </view>
  </scroll-view>
</view>
